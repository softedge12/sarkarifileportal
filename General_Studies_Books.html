 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home - Educational Website</title>
  <link rel="stylesheet" href="welcome.css">
</head>
<body>
  <div id="navbar"></div>
  <div class="section">
    <h1>Welcome to the Educational Website</h1>
    <p>This is the home section. Explore our resources to learn and grow!</p>
    <center><iframe src="https://softedge12.github.io/lessonpdftrial/" width="100%" height="800" style="border:none;"></iframe></center>
  </div>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>

  <!-- Firebase Config -->
  <script src="firebase.js"></script>

  <script>
    // Initialize Firebase Authentication listener
    firebase.auth().onAuthStateChanged((user) => {
      if (user) {
        checkExpiry(user);
        monitorExpiry(user);
      } else {
        location.replace("index.html");
      }
    });

    // Logout function
    function logout() {
      firebase.auth().signOut().then(() => {
        location.replace("index.html");
      });
    }

    // Check for account expiry
 function checkExpiry(user) {
  const userEmail = user.email;

  firebase.database().ref("users").orderByChild("email").equalTo(userEmail).once("value")
    .then(snapshot => {
      if (snapshot.exists()) {
        snapshot.forEach(userData => {
          let pages = userData.val().pages || []; // अगर pages null हैं तो empty array बना दें
          let validPages = [];
          let expiredPages = [];

          const currentDate = new Date();

          pages.forEach(pageData => {
            const expiryDate = new Date(pageData.expiryDate);
            if (currentDate > expiryDate) {
              expiredPages.push(pageData.redirectPage); // एक्सपायर पेज की लिस्ट में डालें
            } else {
              validPages.push(pageData.redirectPage); // वैध पेज की लिस्ट में डालें
            }
          });

          if (expiredPages.length > 0) {
            // **Expired pages को तुरन्त logout कर दें**
            expiredPages.forEach(page => {
              alert("The page " + page + " has expired. Logging you out.");
              firebase.auth().signOut().then(() => {
                location.replace("index.html"); // या कोई अन्य पेज पर रीडायरेक्ट कर सकते हैं
              });
            });
            console.log("Expired pages removed:", expiredPages);
          } else {
            console.log("Valid pages:", validPages);
            // **Valid pages continue रहेंगे**
          }
        });
      } else {
        alert("User not found in the database.");
        firebase.auth().signOut().then(() => {
          location.replace("index.html");
        });
      }
    })
    .catch(error => {
      console.error("Error checking expiry:", error.message);
    });
}



    // Periodic expiry check
    function monitorExpiry(user) {
      setInterval(() => {
        checkExpiry(user);
      }, 60000); // Check every 60 seconds
    } </script>

<script>document.addEventListener("DOMContentLoaded", function() {
  fetch("navbar.html")
    .then(response => response.text())
    .then(data => {
      document.getElementById("navbar").innerHTML = data;
    });
});

function toggleMenu() {
  const menu = document.getElementById('menu');
  menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
}</script>
</body>
</html>
